bundle:
  name: medisure

include:
  - resources/*.yml

workspace:
  root_path: /Workspace/Users/cf166e8f-c501-486f-9e34-76ce106122ab/.bundle/${bundle.name}/${bundle.target}

permissions:
- level: CAN_MANAGE
  group_name: medisure data engineers

variables:
  my_cluster:
    description: "My cluster definition"
    type: complex
    default:
      spark_version: 16.4.x-scala2.12
      spark_conf:
        spark.master: local[*, 4]
        spark.databricks.cluster.profile: singleNode
      azure_attributes:
        first_on_demand: 1
        availability: SPOT_WITH_FALLBACK_AZURE
        spot_bid_max_price: 100
      node_type_id: Standard_F4s_v2
      driver_node_type_id: Standard_F4s_v2
      custom_tags:
        ResourceClass: SingleNode
        cluster-owner: ${bundle.name}
      enable_elastic_disk: true
      data_security_mode: SINGLE_USER
      runtime_engine: STANDARD
      num_workers: 0
  service_principal:
    default: None
    description: "service principal to run the jobs"
  pause_status:
    description: "status of the schedule"
    default: PAUSED

targets:
  sandbox:
    variables:
      service_principal: cf166e8f-c501-486f-9e34-76ce106122ab
      pause_status: PAUSED
    mode: development
    cluster_id: 0918-015202-pf37p9ed
    workspace:
      host: https://adb-1734606006249127.7.azuredatabricks.net/
      root_path: ~/${bundle.name}/
    run_as:
      service_principal_name: ${var.service_principal}
      
  dev:
    variables:
      service_principal: cf166e8f-c501-486f-9e34-76ce106122ab
      pause_status: PAUSED
    mode: production
    workspace:
      host: https://adb-1734606006249127.7.azuredatabricks.net/
    run_as:
      service_principal_name: ${var.service_principal}
    permissions:
    - level: CAN_MANAGE
      service_principal_name: 0e85c8c4-034b-4c5b-af58-8bf6be181af2